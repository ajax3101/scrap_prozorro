import requests
import json

def get_data(request):
    url = "lb-api-sandbox.prozorro.gov.ua/api/2.5/tenders/"  
    headers = {""User-Agent" : "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.0.0 Safari/537.36", "Authorization": "Bearer broker", "Content-Type": "application/json"}  
    response = requests.get(url, headers=headers)

    print(response)

    if response.status_code == 200:
        data = response.json()
        
        # # Зберегти дані в базу даних
        # open_data = OpenProcurementData(data=data)
        # open_data.save()

        return JsonResponse(data, safe=False)
    else:
        error_message = "Помилка при виконанні запиту до Open Procurement API."
        return JsonResponse({"error": error_message}, status=400)
